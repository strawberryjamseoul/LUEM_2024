slope <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_slope.csv")
water_body <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_water.csv")
mapTheme <- theme(plot.title =element_text(size=12),
plot.subtitle = element_text(size=8),
plot.caption = element_text(size = 6),
axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_line(colour = 'transparent'),
panel.grid.minor=element_blank(),
legend.direction = "vertical",
legend.position = "right",
plot.margin = margin(1, 1, 1, 1, 'cm'),
legend.key.height = unit(1, "cm"), legend.key.width = unit(0.2, "cm"))
calgary_fishnet<-st_read("https://raw.githubusercontent.com/luyiiw/LUEM/main/Calgary_JSON/Calgary_Fishnet.json")
calgary_boundary<-st_read("https://raw.githubusercontent.com/luyiiw/LUEM/main/Calgary_JSON/Calgary_Boundary.json")
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(pscl)
library(plotROC)
library(pROC)
library(sf)
library(tidyverse)
library(knitr)
library(kableExtra)
library(tigris)
library(viridis)
library(ggplot2)
library(dplyr)
mapTheme <- theme(plot.title =element_text(size=12),
plot.subtitle = element_text(size=8),
plot.caption = element_text(size = 6),
axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_line(colour = 'transparent'),
panel.grid.minor=element_blank(),
legend.direction = "vertical",
legend.position = "right",
plot.margin = margin(1, 1, 1, 1, 'cm'),
legend.key.height = unit(1, "cm"), legend.key.width = unit(0.2, "cm"))
plotTheme <- theme(
plot.title =element_text(size=12),
plot.subtitle = element_text(size=8),
plot.caption = element_text(size = 6),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 10),
# Set the entire chart region to blank
panel.background=element_blank(),
plot.background=element_blank(),
#panel.border=element_rect(colour="#F0F0F0"),
# Format the grid
panel.grid.major=element_line(colour="#D0D0D0",size=.75),
axis.ticks=element_blank())
# dependent variable
inundation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_depe.csv")
# independent variables
elevation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_elev.csv")
flow_acc <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_fac.csv")
land_use <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_lulc.csv")
slope <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_slope.csv")
water_body <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_water.csv")
calgary_fishnet<-st_read("https://raw.githubusercontent.com/luyiiw/LUEM/main/Calgary_JSON/Calgary_Fishnet.json")
calgary_boundary<-st_read("https://raw.githubusercontent.com/luyiiw/LUEM/main/Calgary_JSON/Calgary_Boundary.json")
calgary_Floods <- calgary_fishnet %>%
left_join(inundation, by = "FID")
calgary_Floods$RANGE<-as.factor(calgary_Floods$RANGE)
ggplot() +
geom_sf(data=calgary_fishnet,color="grey",size=0.2) +
geom_sf(data=calgary_Floods ,aes(fill=RANGE),size=0.5) +
scale_fill_manual(values = c("1"= "#1f78b4", "0" = "#e7f5c6"),
labels = c("1" = "Inundation", "0" = "No Inundation"),
name = "Inundation Status") +
labs(title="Past Flood Inundation in Calgary, Canada",
caption = "Figure 1.1")+
mapTheme+
guides(fill = guide_legend(override.aes = list(shape = 22, size = 6)))
# Creating tables to combine exploratory data
flood_dep <- inundation %>%
select(FID, RANGE) %>%
rename(flood = RANGE) %>%
mutate(flood = factor(flood))
#1 Elevation
elev_comb <- elevation %>%
select(FID, MEAN) %>%
rename(mean_elev= MEAN)
#2 Slope
slope_comb <- slope %>%
select(FID, MAX) %>%
rename(max_slope= MAX)
#3 Water body
water_comb <- water_body %>%
select(FID, MIN) %>%
rename(min_dist_water= MIN)
#4 Flow accumulation
fac_comb <-  flow_acc %>%
select(FID, MEAN) %>%
rename(mean_fac= MEAN)
#5 Land Use/Permeability
lu_comb <- land_use %>%
select(FID, MEAN) %>%
rename(land_use = MEAN) %>%
mutate(permeability = case_when(
land_use < 0.25 ~ '0',
land_use >= 0.25 ~ '1')) %>%
select(-land_use)
# Combining the tables
flood_comb <- flood_dep %>%
inner_join(elev_comb, by = "FID") %>%
inner_join(slope_comb, by = "FID") %>%
inner_join(water_comb, by = "FID") %>%
inner_join(fac_comb, by = "FID")
floodPlotVariables <-
flood_comb %>%
as.data.frame() %>%
select(flood, mean_elev, max_slope, min_dist_water, mean_fac) %>%
gather(variable, value, -flood)
# need to check the labels for flood and not flood
ggplot(floodPlotVariables %>%
group_by(flood, variable) %>%
summarize(mean = mean(value))) +
geom_bar(aes(as.factor(flood),
mean,
fill=as.factor(flood)),
stat="identity") +
facet_wrap(~variable, scales = "free_y") +
scale_fill_manual(values = c("#e7f5c6", "#1f78b4"),
labels = c("No Flood","Flood"),
name = "") +
labs(title="Continuous Variables Impacting Flood Risk",
caption = "Figure 2.1")+
labs(x="Flood", y="Value") +
plotTheme
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(pscl)
library(plotROC)
library(pROC)
library(sf)
library(tidyverse)
library(knitr)
library(kableExtra)
library(tigris)
library(viridis)
library(ggplot2)
library(dplyr)
mapTheme <- theme(plot.title =element_text(size=12),
plot.subtitle = element_text(size=8),
plot.caption = element_text(size = 6),
axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_line(colour = 'transparent'),
panel.grid.minor=element_blank(),
legend.direction = "vertical",
legend.position = "right",
plot.margin = margin(1, 1, 1, 1, 'cm'),
legend.key.height = unit(1, "cm"), legend.key.width = unit(0.2, "cm"))
plotTheme <- theme(
plot.title =element_text(size=12),
plot.subtitle = element_text(size=8),
plot.caption = element_text(size = 6),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 10),
# Set the entire chart region to blank
panel.background=element_blank(),
plot.background=element_blank(),
#panel.border=element_rect(colour="#F0F0F0"),
# Format the grid
panel.grid.major=element_line(colour="#D0D0D0",size=.75),
axis.ticks=element_blank())
# dependent variable
inundation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_depe.csv")
# independent variables
elevation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_elev.csv")
flow_acc <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_fac.csv")
land_use <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_lulc.csv")
slope <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_slope.csv")
water_body <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_water.csv")
calgary_fishnet<-st_read("https://raw.githubusercontent.com/luyiiw/LUEM/main/Calgary_JSON/Calgary_Fishnet.json")
calgary_boundary<-st_read("https://raw.githubusercontent.com/luyiiw/LUEM/main/Calgary_JSON/Calgary_Boundary.json")
calgary_Floods <- calgary_fishnet %>%
left_join(inundation, by = "FID")
calgary_Floods$RANGE<-as.factor(calgary_Floods$RANGE)
ggplot() +
geom_sf(data=calgary_fishnet,color="grey",size=0.2) +
geom_sf(data=calgary_Floods ,aes(fill=RANGE),size=0.5) +
scale_fill_manual(values = c("1"= "#1f78b4", "0" = "#e7f5c6"),
labels = c("1" = "Inundation", "0" = "No Inundation"),
name = "Inundation Status") +
labs(title="Past Flood Inundation in Calgary, Canada",
caption = "Figure 1.1")+
mapTheme+
guides(fill = guide_legend(override.aes = list(shape = 22, size = 6)))
# Creating tables to combine exploratory data
flood_dep <- inundation %>%
select(FID, RANGE) %>%
rename(flood = RANGE) %>%
mutate(flood = factor(flood))
# 1 = flood, 0 = no flood
#1 Elevation
elev_comb <- elevation %>%
select(FID, MEAN) %>%
rename(mean_elev= MEAN)
#2 Slope
slope_comb <- slope %>%
select(FID, MAX) %>%
rename(max_slope= MAX)
#3 Water body
water_comb <- water_body %>%
select(FID, MIN) %>%
rename(min_dist_water= MIN)
#4 Flow accumulation
fac_comb <-  flow_acc %>%
select(FID, MEAN) %>%
rename(mean_fac= MEAN)
#changed from max to mean
#5 Land Use/Permeability
lu_comb <- land_use %>%
select(FID, MEAN) %>%
rename(land_use = MEAN) %>%
mutate(permeability = case_when(
land_use < 0.25 ~ '0',
land_use >= 0.25 ~ '1')) %>%
select(-land_use)
# Removing unnecessary data sets
rm(inundation, elevation, flow_acc, land_use, slope, water_body)
# Combining the tables
flood_comb <- flood_dep %>%
inner_join(elev_comb, by = "FID") %>%
inner_join(slope_comb, by = "FID") %>%
inner_join(water_comb, by = "FID") %>%
inner_join(fac_comb, by = "FID")
floodPlotVariables <-
flood_comb %>%
as.data.frame() %>%
select(flood, mean_elev, max_slope, min_dist_water, mean_fac) %>%
gather(variable, value, -flood)
# need to check the labels for flood and not flood
ggplot(floodPlotVariables %>%
group_by(flood, variable) %>%
summarize(mean = mean(value))) +
geom_bar(aes(as.factor(flood),
mean,
fill=as.factor(flood)),
stat="identity") +
facet_wrap(~variable, scales = "free_y") +
scale_fill_manual(values = c("#e7f5c6", "#1f78b4"),
labels = c("No Flood","Flood"),
name = "") +
labs(title="Continuous Variables Impacting Flood Risk",
caption = "Figure 2.1")+
labs(x="Flood", y="Value") +
plotTheme
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(pscl)
library(plotROC)
library(pROC)
library(sf)
library(tidyverse)
library(knitr)
library(kableExtra)
library(tigris)
library(viridis)
library(ggplot2)
##Elevation
den_dem<-raster("C:/Users/USER/Desktop/LandUseModeling/Assignment3/denver_rast/den_dem.tif")
library(raster)
library(rgdal)
##Elevation
den_dem<-raster("C:/Users/USER/Desktop/LandUseModeling/Assignment3/denver_rast/den_dem.tif")
clipped_den_dem <- mask(den_dem,denfishnet_shp)
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(pscl)
library(plotROC)
library(pROC)
library(sf)
library(tidyverse)
library(knitr)
library(kableExtra)
library(tigris)
library(viridis)
library(ggplot2)
library(dplyr)
mapTheme <- theme(plot.title =element_text(size=12),
plot.subtitle = element_text(size=8),
plot.caption = element_text(size = 6),
axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_line(colour = 'transparent'),
panel.grid.minor=element_blank(),
legend.direction = "vertical",
legend.position = "right",
plot.margin = margin(1, 1, 1, 1, 'cm'),
legend.key.height = unit(1, "cm"), legend.key.width = unit(0.2, "cm"))
plotTheme <- theme(
plot.title =element_text(size=12),
plot.subtitle = element_text(size=8),
plot.caption = element_text(size = 6),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 10),
# Set the entire chart region to blank
panel.background=element_blank(),
plot.background=element_blank(),
#panel.border=element_rect(colour="#F0F0F0"),
# Format the grid
panel.grid.major=element_line(colour="#D0D0D0",size=.75),
axis.ticks=element_blank())
# dependent variable
inundation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_depe.csv")
# independent variables
elevation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_elev.csv")
# dependent variable
inundation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_depe.csv")
# independent variables
elevation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_elev.csv")
flow_acc <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_fac.csv")
land_use <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_lulc.csv")
slope <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_slope.csv")
slope <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_slope.csv")
water_body <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_water.csv")
calgary_fishnet<-st_read("https://raw.githubusercontent.com/luyiiw/LUEM/main/Calgary_JSON/Calgary_Fishnet.json")
calgary_fishnet<-st_read("https://raw.githubusercontent.com/luyiiw/LUEM/main/Calgary_JSON/Calgary_Fishnet.json")
calgary_boundary<-st_read("https://raw.githubusercontent.com/luyiiw/LUEM/main/Calgary_JSON/Calgary_Boundary.json")
calgary_Floods <- calgary_fishnet %>%
left_join(inundation, by = "FID")
calgary_Floods$RANGE<-as.factor(calgary_Floods$RANGE)
ggplot() +
geom_sf(data=calgary_fishnet,color="grey",size=0.2) +
geom_sf(data=calgary_Floods ,aes(fill=RANGE),size=0.5) +
scale_fill_manual(values = c("1"= "#1f78b4", "0" = "#e7f5c6"),
labels = c("1" = "Inundation", "0" = "No Inundation"),
name = "Inundation Status") +
labs(title="Past Flood Inundation in Calgary, Canada",
caption = "Figure 2.1")+
mapTheme+
guides(fill = guide_legend(override.aes = list(shape = 22, size = 6)))
# Creating tables to combine exploratory data
flood_dep <- inundation %>%
select(FID, RANGE) %>%
rename(flood = RANGE) %>%
mutate(flood = factor(flood))
library(caret)
library(pscl)
library(plotROC)
library(pROC)
library(sf)
library(tidyverse)
library(knitr)
library(kableExtra)
library(tigris)
library(viridis)
library(ggplot2)
library(dplyr)
# Creating tables to combine exploratory data
flood_dep <- inundation %>%
select(FID, RANGE) %>%
rename(flood = RANGE) %>%
mutate(flood = factor(flood))
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(pscl)
library(plotROC)
library(pROC)
library(sf)
library(tidyverse)
library(knitr)
library(kableExtra)
library(tigris)
library(viridis)
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(pscl)
library(plotROC)
library(pROC)
library(sf)
library(tidyverse)
library(knitr)
library(kableExtra)
library(tigris)
library(viridis)
library(ggplot2)
mapTheme <- theme(plot.title =element_text(size=12),
plot.subtitle = element_text(size=8),
plot.caption = element_text(size = 6),
axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_line(colour = 'transparent'),
panel.grid.minor=element_blank(),
legend.direction = "vertical",
legend.position = "right",
plot.margin = margin(1, 1, 1, 1, 'cm'),
legend.key.height = unit(1, "cm"), legend.key.width = unit(0.2, "cm"))
plotTheme <- theme(
plot.title =element_text(size=12),
plot.subtitle = element_text(size=8),
plot.caption = element_text(size = 6),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 10),
# Set the entire chart region to blank
panel.background=element_blank(),
plot.background=element_blank(),
#panel.border=element_rect(colour="#F0F0F0"),
# Format the grid
panel.grid.major=element_line(colour="#D0D0D0",size=.75),
axis.ticks=element_blank())
# dependent variable
inundation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_depe.csv")
# independent variables
elevation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_elev.csv")
flow_acc <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_fac.csv")
land_use <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_lulc.csv")
slope <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_slope.csv")
slope <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_slope.csv")
slope <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_slope.csv")
# dependent variable
inundation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_depe.csv")
# dependent variable
inundation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_depe.csv")
# independent variables
elevation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_elev.csv")
# dependent variable
inundation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_depe.csv")
# dependent variable
inundation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_depe.csv")
# independent variables
elevation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_elev.csv")
# dependent variable
inundation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_depe.csv")
inundation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_depe.csv")
inundation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_depe.csv")
slope <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_slope.csv")
slope <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_slope.csv")
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(pscl)
library(plotROC)
library(pROC)
library(sf)
library(tidyverse)
library(knitr)
library(kableExtra)
library(tigris)
library(viridis)
library(ggplot2)
mapTheme <- theme(plot.title =element_text(size=12),
plot.subtitle = element_text(size=8),
plot.caption = element_text(size = 6),
axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_line(colour = 'transparent'),
panel.grid.minor=element_blank(),
legend.direction = "vertical",
legend.position = "right",
plot.margin = margin(1, 1, 1, 1, 'cm'),
legend.key.height = unit(1, "cm"), legend.key.width = unit(0.2, "cm"))
plotTheme <- theme(
plot.title =element_text(size=12),
plot.subtitle = element_text(size=8),
plot.caption = element_text(size = 6),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 10),
# Set the entire chart region to blank
panel.background=element_blank(),
plot.background=element_blank(),
#panel.border=element_rect(colour="#F0F0F0"),
# Format the grid
panel.grid.major=element_line(colour="#D0D0D0",size=.75),
axis.ticks=element_blank())
# dependent variable
inundation <- read.csv("https://raw.githubusercontent.com/luyiiw/LUEM/main/calgary_table/zonal_depe.csv")
